{% extends "simulado/base.html" %}
{% load static %}

{% block title %}{{ app_title }}{% endblock %}

{% block head_css %}
  <link rel="stylesheet" href="{% static 'apostila_cnh/index.css' %}">
{% endblock %}

{% block content %}
  <main class="acnh-page">
    <header class="acnh-header">
      <div>
        <p class="acnh-eyebrow">Leitor da apostila</p>
        <h1 class="acnh-title">{{ app_title }}</h1>
        <p class="acnh-subtitle" id="acnh-documento-titulo">
          {% if tem_documento_ativo %}
            Preparando documento ativo...
          {% else %}
            Nenhum documento ativo encontrado.
          {% endif %}
        </p>
      </div>
      <div class="acnh-actions">
        <a href="{% url 'menu:home' %}" class="acnh-btn acnh-btn-secondary">Voltar ao menu</a>
      </div>
    </header>

    <section class="acnh-toolbar" aria-label="Navegacao de pagina">
      <button type="button" id="acnh-prev-btn" class="acnh-btn">Pagina anterior</button>
      <div class="acnh-page-controls">
        <label for="acnh-page-input">Pagina</label>
        <input id="acnh-page-input" type="number" min="1" value="1">
        <span id="acnh-page-total">/ -</span>
        <button type="button" id="acnh-go-btn" class="acnh-btn acnh-btn-secondary">Ir</button>
      </div>
      <button type="button" id="acnh-next-btn" class="acnh-btn">Proxima pagina</button>
      <div class="acnh-zoom-controls">
        <button type="button" id="acnh-zoom-out-btn" class="acnh-btn acnh-btn-secondary">-</button>
        <span id="acnh-zoom-label">100%</span>
        <button type="button" id="acnh-zoom-in-btn" class="acnh-btn acnh-btn-secondary">+</button>
      </div>
    </section>

    <section class="acnh-search" aria-label="Busca no documento ativo">
      <label for="acnh-search-input">Buscar no documento</label>
      <div class="acnh-search-row">
        <input id="acnh-search-input" type="search" placeholder="Digite um termo (ex.: transito)">
        <button type="button" id="acnh-search-btn" class="acnh-btn acnh-btn-secondary">Buscar</button>
      </div>
      <div class="acnh-search-status" id="acnh-search-status"></div>
      <ol class="acnh-search-results" id="acnh-search-results"></ol>
    </section>

    <section class="acnh-viewer" aria-label="Visualizador PDF">
      <div class="acnh-status" id="acnh-status">Carregando...</div>
      <p class="acnh-gesture-hint" id="acnh-gesture-hint">
        Dica: em telas touch, use pinça para zoom e deslize lateral para trocar de página quando o zoom estiver em 100%.
      </p>
      <div class="acnh-canvas-track" id="acnh-canvas-track">
        <canvas id="acnh-canvas-primary"></canvas>
        <canvas id="acnh-canvas-secondary"></canvas>
      </div>
    </section>

    {{ viewer_config|json_script:"acnh-viewer-config" }}
  </main>
{% endblock %}

{% block body_end %}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" defer></script>
  <script src="{% static 'apostila_cnh/index.js' %}" defer></script>
{% endblock %}
