{% load static %}

<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Simulado Digital</title>
  <link rel="stylesheet" href="{% static 'simulado/inicio.css' %}">
  <link rel="stylesheet" href="{% static 'simulado/scroll-hint.css' %}">
</head>
<body class="inicio-body">
  <main class="inicio-layout">
    <section class="inicio-hero">
      <div class="inicio-hero-top">
        <p class="inicio-badge">Simulado digital</p>
        <button
          type="button"
          class="inicio-btn inicio-btn--ghost inicio-btn--plan"
          id="btn-meu-plano"
          aria-haspopup="dialog"
          aria-controls="modal-meu-plano"
        >
          Meu plano
        </button>
      </div>
      <h1 class="inicio-title">Escolha como começar</h1>
      <p class="inicio-subtitle">
        Você pode iniciar direto com o pacote padrão ou abrir a tela de filtros para montar o treino antes de começar.
      </p>
    </section>

    <section class="inicio-grid">
      <form method="post" action="{% url 'simulado:iniciar' %}" class="inicio-card inicio-card--primary">
        {% csrf_token %}
        <h2 class="inicio-card-title">{{ inicio_rapido.label|default:"Início rápido" }}</h2>
        <p class="inicio-card-text">
          {{ inicio_rapido.hint|default:"Usa o curso e os filtros padrão definidos na configuração." }}
        </p>

        <div class="inicio-meta">
          <span class="inicio-pill">Modo {{ quick_filters.modo|default:"PROVA" }}</span>
          <span class="inicio-pill">{{ quick_filters.qtd|default:10 }} questões</span>
          {% if quick_filters.dificuldade %}
            <span class="inicio-pill">Dificuldade {{ quick_filters.dificuldade }}</span>
          {% else %}
            <span class="inicio-pill">Dificuldade mista</span>
          {% endif %}
          {% if quick_filters.com_imagem %}<span class="inicio-pill">Só com imagem</span>{% endif %}
          {% if quick_filters.so_placas %}<span class="inicio-pill">Só placas</span>{% endif %}
        </div>

        <input type="hidden" name="curso_id" value="{{ quick_curso_id|default_if_none:'' }}">
        <input type="hidden" name="modulo_id" value="">
        <input type="hidden" name="modo" value="{{ quick_filters.modo|default:'PROVA' }}">
        <input type="hidden" name="dificuldade" value="{{ quick_filters.dificuldade|default:'' }}">
        <input type="hidden" name="com_imagem" value="{{ quick_filters.com_imagem|yesno:'1,0' }}">
        <input type="hidden" name="so_placas" value="{{ quick_filters.so_placas|yesno:'1,0' }}">
        <input type="hidden" name="qtd" value="{{ quick_filters.qtd|default:10 }}">

        <button
          type="submit"
          class="inicio-btn inicio-btn--primary"
          {% if not quick_curso_id or not inicio_rapido.habilitado %}
            disabled
            title="{{ inicio_rapido.tooltip|default:'Curso padrão não encontrado' }}"
          {% endif %}
        >
          {{ inicio_rapido.label|default:"Início rápido" }}
        </button>

        <p class="inicio-hint">
          {% if not quick_curso_id %}
            Curso padrão não encontrado. Ajuste o config do simulado para habilitar.
          {% else %}
            Inicia imediatamente usando as preferências padrão.
          {% endif %}
        </p>
      </form>

      <div class="inicio-card inicio-card--secondary">
        <h2 class="inicio-card-title">Monte seu Simulado</h2>
        <p class="inicio-card-text">
          Monte o simulado escolhendo curso, módulo, quantidade e demais filtros antes de começar.
        </p>
        <div class="inicio-card-actions">
          <a href="{% url 'simulado:config' %}" class="inicio-btn inicio-btn--primary">Monte seu Simulado</a>
        </div>
        <div class="inicio-divider"></div>
        <ul class="inicio-list">
          <li>Ver disponibilidade e estatísticas por dificuldade.</li>
          <li>Selecionar modo Prova ou Estudo.</li>
          <li>Filtrar por questões com imagem ou só placas.</li>
        </ul>
      </div>
    </section>
  </main>

  <dialog
    id="modal-meu-plano"
    class="inicio-modal"
    aria-labelledby="modal-meu-plano-title"
  >
    <div class="inicio-modal__panel" role="document" tabindex="-1">
      <div class="inicio-modal__header">
        <h2 id="modal-meu-plano-title" class="inicio-modal__title">Meu plano</h2>
        <button type="button" class="inicio-modal__close" data-modal-close aria-label="Fechar modal">×</button>
      </div>
      <div class="inicio-modal__body">
        {% if plano_status and plano_status.ativo %}
          <p class="inicio-card-text">Plano {{ plano_status.nome }}</p>
          <div class="inicio-meta">
            {% if plano_status.ilimitado %}
              <span class="inicio-pill">Simulados ilimitados</span>
            {% else %}
              <span class="inicio-pill">
                Limite {{ plano_status.limite_qtd }} / {{ plano_status.limite_periodo_label }}
              </span>
              <span class="inicio-pill">Usados {{ plano_status.usos }}</span>
              <span class="inicio-pill">Restantes {{ plano_status.restantes }}</span>
            {% endif %}
          </div>
          {% if plano_status.janela_fim %}
            <p class="inicio-hint">Janela atual até {{ plano_status.janela_fim|date:"d/m/Y H:i" }}</p>
          {% endif %}
          {% if plano_status.valid_until %}
            <p class="inicio-hint">Válido até {{ plano_status.valid_until|date:"d/m/Y H:i" }}</p>
          {% endif %}
        {% else %}
          <p class="inicio-card-text">
            Nenhum plano ativo - Entre em contato com (53) 99121-4707 para adquirir um plano
          </p>
        {% endif %}
      </div>
    </div>
  </dialog>

  <div class="scroll-hint__sentinel" aria-hidden="true"></div>
  <script src="{% static 'simulado/inicio.js' %}"></script>
  <script src="{% static 'simulado/scroll-hint.js' %}"></script>
</body>
</html>
